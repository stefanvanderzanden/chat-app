{% load chat_extras %}
<div
        id="room-detail-content"
        data-active-room-id="room-{{ room.id }}"
        class="flex flex-col"
>
    <header class="pb-4 border-b border-gray-200">
        <h2 class="text-2xl font-bold text-gray-800">
            {% if room.room_type == "direct" %}
                <div class="flex items-center gap-4">
                    <div class="relative w-10 h-10 overflow-hidden bg-gray-100 rounded-full dark:bg-gray-600">
                        <svg class="absolute w-12 h-12 text-gray-400 -left-1" fill="currentColor" viewBox="0 0 20 20"
                             xmlns="http://www.w3.org/2000/svg">
                            <path fill-rule="evenodd" d="M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z"
                                  clip-rule="evenodd"></path>
                        </svg>
                    </div>
                    {% room_display_name room request.user %}

                </div>
            {% else %}
                # {% room_display_name room request.user %}
            {% endif %}
        </h2>
    </header>

    <!-- Chat log -->
    <div id="chat-container"
         class="flex-1 overflow-y-auto mt-4 bg-white border border-gray-200 rounded-lg p-4 space-y-2 shadow-sm">
        <div id="chat-log" class="space-y-2">
            {% for message in messages %}
                {% ifchanged message.timestamp|date:"Y-m-d" %}
                    <!-- Divider -->
                    <div class="flex items-center my-4">
                        <div class="flex-grow border-t border-gray-300"></div>
                        <span class="mx-4 text-xs text-gray-500 uppercase tracking-wide">
                        {{ message.timestamp|date:"d-m-Y" }}
                    </span>
                        <div class="flex-grow border-t border-gray-300"></div>
                    </div>
                {% endifchanged %}
                <div
                    class="chat-message flex items-start space-x-3 px-3 py-1 hover:bg-gray-50"
                    data-date="{{ message.timestamp|date:'Y-m-d' }}"
                >
                    <!-- Avatar -->
                    <div class="relative w-10 h-10 overflow-hidden bg-gray-100 rounded-full dark:bg-gray-600">
                        <svg class="absolute w-12 h-12 text-gray-400 -left-1" fill="currentColor" viewBox="0 0 20 20"
                             xmlns="http://www.w3.org/2000/svg">
                            <path fill-rule="evenodd" d="M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z"
                                  clip-rule="evenodd"></path>
                        </svg>
                    </div>

                    <!-- Message content -->
                    <div class="flex-1">
                        <!-- Header: name + timestamp -->
                        <div class="flex items-baseline space-x-2">
                            <span class="font-medium text-gray-900">{{ message.user.full_name }}</span>
                            <span class="text-xs text-gray-500">{{ message.timestamp|date:"H:i" }}</span>
                        </div>

                        <!-- Actual message -->
                        <p class="text-gray-800">
                            {{ message.text }}
                        </p>
                    </div>
                </div>
            {% endfor %}
        </div>
    </div>

    <!-- Chat form -->
    <form id="chat-form" class="mt-4 flex space-x-2" action="javascript:void(0);">
        <input id="chat-message-input"
               type="text"
               placeholder="Typ je bericht..."
               class="flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring focus:ring-mint-200 focus:outline-none"
               autocomplete="off">
        <button type="submit"
                class="px-4 py-2 bg-mint-500 text-white font-medium rounded-lg hover:bg-mint-600 transition">
            Verstuur
        </button>
    </form>
</div>
